# mailingAPI
*mailingAPI* - Это проект, который позволяет совершать асинхронную рассылку сообщений по определённой выборке пользователей. 
Реализовано [API](#API)

*Основные используемые технологии:* Django 3.2.16, DRF, PostgreSQL, Celery, Redis, Docker

## Первоначальная настройка
1. Запускаем программу Docket Desktop
2. Открываем удобный терминал и переходим в папку, где расположен файл «docker-compose.yml»
3. Вводим туда команду docker-compose build
4. Когда сборка завершится, прописываем:
docker-compose run --rm web-app sh -c "python manage.py makemigrations && python manage.py migrate && python manage.py createsuperuser"
5. После третьей команды запустится процесс создания суперпользователя. Следуем командам в терминале и вводим данные от учётной записи, для доступа ко всему функционалу приложения

## Запуск проекта 
1. Убедившись, что первоначальная настройка завершилась, открываем удобный терминал и переходим в папку где расположен файл «docker-compose.yml»
2. Вводим туда команду: docker-compose up
3. Переходим на локальный сервер как в системе указав порт “8000”. На windows это - “http://127.0.0.1:8000”

## Функционал
1. UX админ-панель. 
Чтобы сюда войти, нужно добавить постфикс - “/admin/” к основному адресу и ввести логин и пароль суперпользователя в открывшейся форме. Здесь есть возможность:
   * Смотреть, добавлять, редактировать и удалять клиентов, рассылки и сообщения. 
     * Для просмотра объектов модели, нужно нажать на её название.
     * Для добавления нового объекта модели нужно нажать на плюс рядом с названием модели, заполнить все поля и нажать кнопку сохранить.
     * Нажав на id объекта можно перейти на страницу его редактирования, где также есть возможность удалить.
   * Добавлять новых пользователей сервиса, менять пароли и удалять существующих. Смотреть их токены для API запросов.
     * Новая учётная запись создаётся как и другой объект.
     * Чтобы получить токен для пользователя, находясь на главной странице админ-панели, нужно нажать на поле “Tokens”, выбрать нужного пользователя из списка и нажать кнопку сохранить.
2. <p id="API">API</p>

   * Неавторизованный пользователь не сможет получить информацию. 
   * Если используется учётная запись суперпользователя, то доступ будет к взаимодействию со всей информации, а у обычных пользователей, только связанной с ними.
   * Для выполнения любого запроса (GET, PUT, PATCH, DELETE, HEAD, OPTIONS), нужно в Headers указать ключ - “Authorization” и значение к нему - “Token <значение токена без угольных скобок>“
   * Для перехода на главную страницу с основными API маршрутами, нужно добавить постфикс - “/api/v1/” в адресную строку. Для получения более конкретной информации нужно добавить постфиксы, приведённые ниже, где <i> - целые числа. <i> не обязательно указывать, а <o> обязательно. Постфиксы:
     * /client/<i> - Без <i> будет получить список клиентов. Добавив целое число на место <i>, можно получить информацию о пользователе с id равным этому числу, а также возможность его отредактировать и удалить (GET, PUT, PATCH, DELETE, HEAD, OPTIONS).
     * /message/<i> - Без <i> будет получить список сообщений. Добавив целое число на место <i>, можно получить информацию о сообщении с id равным этому числу, а также возможность его отредактировать и удалить (GET, PUT, PATCH, DELETE, HEAD, OPTIONS).
     * /mailing/<i> - Без <i> будет получить список сообщений. Добавив целое число на место <i>, можно получить информацию о рассылке с id равным этому числу, а также возможность её отредактировать и удалить (GET, PUT, PATCH, DELETE, HEAD, OPTIONS).
     * /statistic-messages/<i> - Без <i> будет получить список сообщений по статусам (GET, HEAD, OPTIONS). Добавив целое число на место <i>, можно получить информацию о сообщениях с конкретным статусом где:
       1 - Ожидает отправки
       2 - Отправлено
       3 - Не отправлено. Дата и время клиента больше выбранного в рассылке
       4 - Не отправлено. Ошибка внешнего API

     * /messages-in-mailing/<o> - Получить детальную статистику по рассылке со всеми её сообщениями (GET, HEAD, OPTIONS).
     * /auth-rest/login/ - Страница с авторизацией
     * /auth-rest/logout/ - Выйти из учётной записи
     * Постфикс “/docs/” добавленный к основному адресу направит на страницу Swagger UI с OpenAPI.
     * Постфикс “/add-users/” добавленный к основному адресу запустит создание 2160 клиентов для тестов. Сработает только если используется учётная запись суперпользвателя.
     * Постфикс “/del-users/” добавленный к основному адресу удаляет всех пользователей. Сработает только если используется учётная запись суперпользвателя.
